---
layout: default
title: ! "myMail App Case Study: Developing For Apple Watch Without The Device"
header: |
    <link href="/css/syntax.css" rel="stylesheet" type="text/css" />
tags: smashingmagazine mailru
---
<p>Оригинал опубликован по ссылке: <a href="https://www.smashingmagazine.com/2015/08/mymail-app-case-study/">https://www.smashingmagazine.com/2015/08/mymail-app-case-study/</a></p>


<article class="post-222470 post type-post status-publish format-standard has-post-thumbnail hentry category-mobile tag-apps tag-case-studies tag-devices" vocab="http://schema.org/" typeof="TechArticle">

		<h1>
		<span property="name">myMail App Case Study: Developing For Apple Watch Without The Device</span>
	</h1>

			
<ul class="pmd clearfix">
	<li class="a" property="author" typeof="person" resource="#authorname">By <a href="https://www.smashingmagazine.com/author/nikolaymorev/" title="Posts by Nikolay Morev" rel="author">Nikolay Morev</a></li>
				<li class="rd" property="datePublished" content="August 5th, 2015">August 5th, 2015</li>
				<li class="tags" property="keywords"><a href="https://www.smashingmagazine.com/tag/apps/">Apps</a><a href="https://www.smashingmagazine.com/tag/case-studies/">Case Studies</a><a href="https://www.smashingmagazine.com/tag/devices/">Devices</a></li>
		</ul>
	
	<div class="ad ed">
	<div class="oa_zone--ad cad" id="cad" data-ad-name="Medium Rectangle" data-ad-zone="22" data-ad-media="all"></div>
</div>

	<p>How do you write a useful app for the Apple Watch? In what ways does it differ from coding for iOS? And what if you don&#8217;t have a Watch on hand to test with?</p>
<p>Before the launch of the Apple Watch, our iOS team at myMail (one of the popular alternative email apps for iOS and Android) worked tirelessly with a simulator to create a new Apple Watch app. We wanted the first buyers of the Apple Watch to have the opportunity to use myMail from day one. <strong>What we learned through using the simulator and creating the app</strong> &mdash; including the Apple Watch&#8217;s UI quirks, passing data between devices, and the rigors of simulator-only development &mdash; is described below and (we hope) will help iOS developers get to results, faster, and avoid a few headaches down the road.</p>
<h3  id="ui-development-for-apple-watch">UI Development For Apple Watch <a href="#ui-development-for-apple-watch" aria-label="Link to section 'UI Development For Apple Watch'" class="sr hsl">Link</a></h3>
<p>Writing code for the Apple Watch <strong>isn&#8217;t very different from writing code for iOS</strong>, since all the logic is processed on the iPhone. But when it comes to user interface development, it gets more complicated: new classes have been created for the Watch, classes which aren’t used elsewhere. At the moment, there are only 11 such classes, but the first version of iOS didn&#8217;t have many features either. We know the number of these features increased exponentially in following versions, so we hope that a similar future awaits the Apple Watch SDK. At present, though, here&#8217;s what the reality of UI development for Apple Watch looks like.</p>
<h4  id="only-apple-watch-components-can-be-used">Only Apple Watch Components Can Be Used <a href="#only-apple-watch-components-can-be-used" aria-label="Link to section 'Only Apple Watch Components Can Be Used'" class="sr hsl">Link</a></h4>
<p>Here&#8217;s the very first disappointment you encounter during UI development for the Watch: you have to forget all the fancy buttons, animations and screens you previously created for the iPhone. There&#8217;s no way to use them here because only visual components specifically for the Apple Watch can be used in the UI.</p>
<h4  id="new-layout-model">New Layout Model <a href="#new-layout-model" aria-label="Link to section 'New Layout Model'" class="sr hsl">Link</a></h4>
<p>Before iOS 6, it was possible to define specific coordinates of various elements and set rules for resizing elements as the screen stretched out. Not long ago, Apple presented a new layout model for its phones called &#8220;Auto Layout&#8221;, which allowed all these rules to be set in a more flexible way. You&#8217;d expect that it would be possible to use Auto Layout for the Apple Watch, but its SDK has an <strong>entirely new layout model</strong> that resembles the one used in the Android SDK. The entire interface consists of containers, which are filled with <a href="https://developer.apple.com/library/prerelease/ios/documentation/General/Conceptual/WatchKitProgrammingGuide/CreatingtheUserInterface.html#//apple_ref/doc/uid/TP40014969-CH4-SW1">elements vertically or horizontally</a><sup class="po" id="note-1"><a href="#1">1</a></sup>. By iOS 9, with the introduction of UIStackview, <a href="https://developer.apple.com/library/prerelease/ios/documentation/UIKit/Reference/UIStackView_Class_Reference/">this layout model</a><sup class="po" id="note-2"><a href="#2">2</a></sup> was made available on other devices.</p>
<figure><img src="/texts/mailru/assets/01-layout-model-opt.png" alt="Before (left) and after (right) hiding square and text" /><br />
<figcaption>Before (left) and after (right) hiding square and text.</figcaption>
</figure>
<h4  id="realignment-after-hiding-elements">Realignment After Hiding Elements <a href="#realignment-after-hiding-elements" aria-label="Link to section 'Realignment After Hiding Elements'" class="sr hsl">Link</a></h4>
<p>The Apple Watch has an interesting <strong>feature that wasn&#8217;t available in the iOS SDK</strong>: when you hide an element, it doesn&#8217;t simply disappear from the screen — all the other elements take its place, leaving no empty space. Thanks to this feature, you can place several screens on one screen with the possibility of dynamically switching between them.</p>
<p>The Apple Watch SDK offers several possibilities for switching between screens, including animated pop-ups from below and from the side (multi-page UI). There&#8217;s also an interesting alternative, though unofficial and undocumented, that lets you swap screens without any animation by emulating switching screens when elements are hidden.</p>
<h4  id="context-instead-of-interface-controller">Context Instead Of Interface Controller <a href="#context-instead-of-interface-controller" aria-label="Link to section 'Context Instead Of Interface Controller'" class="sr hsl">Link</a></h4>
<p>While in the iOS SDK, we could initialize <code>UIViewController</code> and assign any properties to it. In the Apple Watch SDK, the <strong>interface controller</strong> (<code>WKInterfaceController</code>) is created by the system, and <strong>it&#8217;s impossible to access it</strong> from code. Instead, developers are given a new parameter called <code>context</code>, which can be conveyed to the controller when displayed. Inside the controller, it&#8217;s available in the <code>awakeWithContext</code> method. Through <code>context</code>, it&#8217;s possible to convey the same parameters we used to pass during creation, such as blocks that the child controller will have to invoke in order to pass data to the parent controller, the ID of the email to be opened, and so on.</p>
<h4  id="animation">Animation <a href="#animation" aria-label="Link to section 'Animation'" class="sr hsl">Link</a></h4>
<p>In the Apple Watch, <strong>possibilities for creating animations are very limited</strong>. There are no CoreAnimation and UIKit frameworks, which let us create animations programmatically. The only way to animate anything in Apple Watch is to create a sequence of pictures, something like an animated GIF.</p>
<p>On the one hand, this approach lacks flexibility because animation parameters can’t be set dynamically in the code. On the other hand, it may be more convenient for developers, since designers bear full responsibility for creating an animation and providing it as a sequence of ready-to-use pictures. The only thing remaining for the developer is to <strong>display them either in loop mode, no-loop mode, or even partially</strong> — using only some of the images.</p>
<h4  id="glance">Glance <a href="#glance" aria-label="Link to section 'Glance'" class="sr hsl">Link</a></h4>
<p>A <a href="https://developer.apple.com/watch/human-interface-guidelines/app-components/#glances">glance</a><sup class="po" id="note-3"><a href="#3">3</a></sup> is a small screen that any app can create to display pertinent information, like the number of unread emails and the sender&#8217;s name of the latest unread email. It’s up to the user to choose which glances will and will not be shown on the screen. To see the glances, the <strong>user must swipe from bottom to top on the watch’s screen</strong>, then swipe left or right to switch between glances on various apps. When a glance appears on screen it shows old info at first, allowing it to be displayed as quickly as possible. Apps usually update their glances with new data in about one second. Glances can’t be scrolled, so they can only contain as much info as will fit on a single screen.</p>
<h4  id="recommended-font-styles">Recommended Font Styles <a href="#recommended-font-styles" aria-label="Link to section 'Recommended Font Styles'" class="sr hsl">Link</a></h4>
<p>The Xcode Interface Builder now offers a set of recommended font styles. Previously, you had the ability to choose the system font, its size, and style (italic, bold, etc.). Now there are font templates like Body and Title. The templates are optional, but we hope developers will use them, and that user interfaces will soon start to look more uniform.</p>
<h4  id="overlapping-of-elements">Overlapping Of Elements <a href="#overlapping-of-elements" aria-label="Link to section 'Overlapping Of Elements'" class="sr hsl">Link</a></h4>
<p>Unlike iOS, the <strong>Apple Watch doesn&#8217;t allow elements to overlap</strong>. The only way to get around this restriction is to set the group background as a picture and insert the element into the group contents. We used this workaround in the myMail app to display the screen for a new email notification: the sender&#8217;s avatar, captioned with the subject and sender&#8217;s name (for the text to be discernible, an underlying gradient is added).</p>
<figure><img src="/texts/mailru/assets/image02-opt.png" alt="Apple Watch doesn’t allow elements to overlap" /><br />
<figcaption>Apple Watch doesn’t allow elements to overlap. The only way to get around this restriction is to set the group background as a picture and insert the element into the group contents.</figcaption>
</figure>
<h4  id="support-for-attributed-strings">Support For Attributed Strings <a href="#support-for-attributed-strings" aria-label="Link to section 'Support For Attributed Strings'" class="sr hsl">Link</a></h4>
<p>Among the nice features we were surprised to find in the Apple Watch UI was support for <a href="https://developer.apple.com/library/ios/documentation/General/Conceptual/WatchKitProgrammingGuide/TextandLabels.html">attributed strings in labels</a><sup class="po" id="note-4"><a href="#4">4</a></sup>. Thanks to this feature, we can <strong>display text with differently formatted segments</strong>. Let&#8217;s take Glance, for example: we can highlight part of the text with some other color and format another part with a bigger font size.</p>
<figure><img src="/texts/mailru/assets/image03-opt.png" alt="Apple Watch UI supports attributed strings in labels" /><br />
<figcaption>Apple Watch UI supports attributed strings in labels. E.g. we can highlight part of the text with some other color and format another part with a bigger font size.</figcaption>
</figure>
<h4  id="digital-crown-and-force-touch">Digital Crown And Force Touch <a href="#digital-crown-and-force-touch" aria-label="Link to section 'Digital Crown And Force Touch'" class="sr hsl">Link</a></h4>
<p>The Apple Watch has inherited the wheel (crown) from conventional watches, calling it the <a href="https://developer.apple.com/watch/human-interface-guidelines/#digital-crown">digital crown</a><sup class="po" id="note-5"><a href="#5">5</a></sup>, and features a new gesture called <a href="https://developer.apple.com/watch/human-interface-guidelines/#force-touch">force touch</a><sup class="po" id="note-6"><a href="#6">6</a></sup>. It&#8217;s unclear how either of these elements will be used, and it seems that even their creators at Apple aren&#8217;t sure how to use them.</p>
<p>For example, the digital crown is sometimes used for scrolling a list, sometimes for zooming, and sometimes for moving between storyboard elements. It also controls <a href="https://developer.apple.com/watch/human-interface-guidelines/ui-elements/#sliders">sliders</a><sup class="po" id="note-7"><a href="#7">7</a></sup>, which allows the user to change various values like text size. Since the digital crown&#8217;s behavior is outside the developers&#8217; control, we have to put up with the functions that Apple assigns to it. <strong>Sliders can be controlled through either tapping images or via the wheel</strong>. Sometimes the slider may be inside the scrollable screen. In this case you should first tap the slider to control it via the wheel.</p>
<figure><img src="/texts/mailru/assets/image04-opt.png" alt="Example of using the crown: Apple Watch Settings, Brightness and Text Size" /><br />
<figcaption>Example of using the crown: Apple Watch Settings, Brightness and Text Size.</figcaption>
</figure>
<p>Force touch is a new feature for iOS that responds to the amount of pressure a user places on the touchscreen. When the watch is pressed firmly, it makes the <a href="https://developer.apple.com/watch/human-interface-guidelines/ui-elements/#menus">current screen’s menu</a><sup class="po" id="note-8"><a href="#8">8</a></sup> appear. As far as force touch is concerned, we&#8217;ve decided to wait a bit — the first version of the myMail app doesn&#8217;t include force touch support.</p>
<h4  id="image-caching">Image Caching <a href="#image-caching" aria-label="Link to section 'Image Caching'" class="sr hsl">Link</a></h4>
<p>The image caching mechanism in Apple Watch is somewhat peculiar, but quite logical if we recall what a Watch app is. In brief, it consists of several parts: the main app (“host app”) and the WatchKit extension being run on the iPhone; and the Watch app, which is run right on the smartwatch.</p>
<p>What happens when an image is displayed on the Watch&#8217;s screen? The main app launches on the iPhone and forms the image; it downloads it from the internet, for example. The image is then transmitted via Bluetooth or Wi-Fi to the Watch.</p>
<p>This is where the Watch&#8217;s peculiarities begin. In conventional image caching, we&#8217;d simply download the image, show it to the user, and save it in a file until next time. But on the Apple Watch, we can&#8217;t simply put the image into a file on the iPhone, because we&#8217;d have to transmit it back to the Watch every time. For such occasions, there&#8217;s a 20MB image cache available on the Watch.</p>
<p>Interestingly, <strong>it&#8217;s possible to put an image into the Watch&#8217;s cache</strong>, but only a standard control can get it from there, and as far as we know there&#8217;s no direct way to tell whether an image has been cached or not. One way is to use API methods: we request the dimensions of the file named as the supposedly cached image. If we receive the dimensions, we know it&#8217;s there. If not, we know we need to download it.</p>
<h4  id="absence-of-application-lifecycle-notifications">Absence Of Application Lifecycle Notifications <a href="#absence-of-application-lifecycle-notifications" aria-label="Link to section 'Absence Of Application Lifecycle Notifications'" class="sr hsl">Link</a></h4>
<p>An iOS app has its own life cycle: it launches, goes to the background, gets pushed out of memory, and more. As these events occur, an app gets corresponding notifications. <strong>There are no such notifications on the Apple Watch</strong>, so object creation at app launch is a bit complicated. Additionally, problems with third-party libraries may occur if they require these notifications to operate correctly; for example, the Flurry Analytics library fails to send statistical data to the server, but only because it doesn&#8217;t receive the necessary notifications.</p>
<p>Here&#8217;s the problem: unlike an iOS app with one access point where everything can be initialized all at once, an Apple Watch app has three access options: glance, notification, and main app. But in all three cases, launching a Watch app is connected with displaying the first controller. It lets us use the <code>awakeWithContext</code> method.</p>
{% highlight objc %}
@implementation MRWKContactsInterfaceController
‐ (void)awakeWithContext:(id)context {
    [super awakeWithContext:context];
    // Call app initialization code from your main interface controller's awakeWithContext method
    [MRWKInitialization extensionDidFinishLaunching];
    //...     
  }

// Separate class where we store all initialization code for our watch extension
@implementation MRWKInitialization
  +(void)extensionDidFinishLaunching {         
// Wrap initialization in dispatch_once to prevent calling it multiple times accidentaly
      static dispatch_once_t onceToken;
      dispatch_once(&onceToken,^{
        // This is where we create our global object instances and initialize external SDKs
        [self internalExtensionDidFinishLaunching];
   });
 } 
{% endhighlight %}
<p>Moreover, it&#8217;s possible to use the <code>initialize</code> method in one of the extension classes, which will be executed on the first reference to this class.</p>
<p>You can also use <strong>lazy initialization</strong>, in which objects are created only when they&#8217;re referred to. But this doesn&#8217;t help with statistics. For example, Flurry needs to know exactly when an app was launched.</p>
<h3  id="interaction-with-the-main-app">Interaction With The Main App <a href="#interaction-with-the-main-app" aria-label="Link to section 'Interaction With The Main App'" class="sr hsl">Link</a></h3>
<p>The capabilities of an Apple Watch app are limited, so we can invoke the main app to perform actions not supported by the Watch app. Here are several ways to do that.</p>
<h4  id="open-parent-application">Open Parent Application <a href="#open-parent-application" aria-label="Link to section 'Open Parent Application'" class="sr hsl">Link</a></h4>
<p>There&#8217;s a new API, <code>+[WKInterfaceController openParentApplication:reply:]</code>, which lets you invoke the main app from the Watch app. It <strong>launches the main app in the background</strong>, performs the requested actions, and returns the result.</p>
{% highlight objc %}
@implementation WKInterfaceController (MRWKParentApplicationActions)
+ (void)mrwk_markMessageIdAsRead:(NSString *)messageId
  accountName:(NSString *)accountName
  completionBlock:(MRWKParentApplicationActionsCompletionBlock)completionBlock {
  MRWKParentApplicationAction *action = [MRWKParentApplicationAction markAsReadActionWithMessageId:messageId
    accountName:accountName];
  [self openParentApplication:action.dictionary reply:^(NSDictionary *replyInfo, NSError *error) {
    if (completionBlock) {
      MRWKParentApplicationReplyInfo *info = [[MRWKParentApplicationReplyInfo alloc] initWithDictionary:replyInfo];
      completionBlock(info.success, error ?: info.error);
    }
  }];
}
@end 
{% endhighlight %}
<h4  id="application-groups">Application Groups <a href="#application-groups" aria-label="Link to section 'Application Groups'" class="sr hsl">Link</a></h4>
<p>The second way to get a Watch app and its counterpart to interact is with application groups. Under iOS, <strong>all applications and extensions are run in separate sandboxes</strong>, restricted parts of the file system that can only be accessed by those applications or extensions. For the apps to use shared resources or exchange files, there are application groups. If a host app and a watch extension are assigned a common application group, a folder is created in the file system, and both of them get access to it. We used this feature in particular to give the myMail Watch app access to the main app’s database (all emails, contacts, etc.) and to the <code>NSUserDefaults</code> object (various user settings).</p>
<h4  id="darwin-notifications">Darwin Notifications <a href="#darwin-notifications" aria-label="Link to section 'Darwin Notifications'" class="sr hsl">Link</a></h4>
<p><em>Darwin notifications</em> is a system for <strong>exchanging messages between iOS processes</strong>. This feature has existed for a long time, but only when extensions appeared did it become important (in particular, the WatchKit extension). They make it <strong>possible to send a notification to the Watch</strong> if something changes in the main app, like a new contact being added in the main app while the contact list is open on the Watch. Darwin notifications let you send an event from the main app, allowing the Watch to update the contact list and databases.</p>
<figure><a href="/texts/mailru/assets/image05-opt.png"><img src="/texts/mailru/assets/image05-opt-small.png" alt="image05-opt-small" /></a><sup class="po" id="note-9"><a href="#9">9</a></sup><br />
<figcaption>Dynamic and static notification. (<a href="/texts/mailru/assets/image05-opt.png">View large version</a><sup class="po" id="note-10"><a href="#10">10</a></sup>)</figcaption>
</figure>
<h4  id="handoff">Handoff <a href="#handoff" aria-label="Link to section 'Handoff'" class="sr hsl">Link</a></h4>
<p>In the latest iOS version, Apple introduced the new <a href="https://developer.apple.com/watch/human-interface-guidelines/app-components/#handoff">Handoff function</a><sup class="po" id="note-11"><a href="#11">11</a></sup>, which has been actively promoted. Handoff is a useful tool for the user. It can be viewed as a <strong>means of interaction with the main app</strong>. In this case, interaction doesn&#8217;t imply direct data exchange, but consists of creating activity from the Watch that makes a specific screen on the main app display once it&#8217;s launched. For example, if a user begins composing an email on the Watch and then later launches the app on their iPhone, Handoff lets them immediately and automatically open the screen for composing a new message.</p>
<section>
<div class="oa_zone--ad icad" id="cad-middle" data-ad-name="Content Ad Middle" data-ad-zone="110" data-ad-media="all"></div>
</section>
<h3  id="development-without-a-device">Development Without A Device <a href="#development-without-a-device" aria-label="Link to section 'Development Without A Device'" class="sr hsl">Link</a></h3>
<p>While we were developing the myMail app, we could only use the simulator, which wasn&#8217;t entirely accurate. This is the primary pitfall of developing an app for Apple Watch: the inability to understand how things would work on a real device. Even the official documentation differs between content and reality.</p>
<h4  id="receipt-of-multiple-notifications">Receipt Of Multiple Notifications <a href="#receipt-of-multiple-notifications" aria-label="Link to section 'Receipt Of Multiple Notifications'" class="sr hsl">Link</a></h4>
<p>The simulator doesn&#8217;t reflect some things at all. For example, the documentation describes the following scenario: when several notifications are received, a round app icon appears on the screen with the text “<em>N</em> new notifications.” However, the <strong>simulator doesn&#8217;t show how that will look</strong>. It may seem unimportant, but in practice it might mean some unpleasant surprises. For instance, the app name might not show up as expected or the icon might be displayed incorrectly. These things are impossible to predict, and the only way to minimize risk is to follow the documentation in every detail.</p>
<h4  id="emoji">Emoji <a href="#emoji" aria-label="Link to section 'Emoji'" class="sr hsl">Link</a></h4>
<p>Apple&#8217;s presentation said the Watch would feature beautiful animated emoticons that could be customized. Our myMail app also supports them — the emoticons can be added via the standard screen for composing a new message. However, during development, we didn&#8217;t know exactly how they&#8217;d look in the message, what format they&#8217;d be in when sent to the app, or how they had to be transformed when inserted into the message. The documentation didn&#8217;t specify the format, either. In the first version of myMail, we decided to proceed from the assumption that the emoticons would come as text, which turned out to be correct.</p>
<h4  id="voice-recognition">Voice Recognition <a href="#voice-recognition" aria-label="Link to section 'Voice Recognition'" class="sr hsl">Link</a></h4>
<p>There was another issue related to composing an email: how voice recognition would work. In general, everything seemed clear: we push the microphone, speak, and get the recognized text. But the details might differ. For example, the user might get several variants rather than a single line of text.</p>
<h4  id="unauthorized-user">Unauthorized User <a href="#unauthorized-user" aria-label="Link to section 'Unauthorized User'" class="sr hsl">Link</a></h4>
<p>Here&#8217;s another ambiguous scenario: assume somebody has installed the myMail app on their iPhone, but has never launched it, and as a result has never been authorized. Would the Watch app be available in this case? Would the user be able to launch it from the Apple Watch display? To stay on the safe side, we made sure that if the Watch app was launched, an unauthorized user would receive the following notification, “Open the app on your phone to sign in.”</p>
<h4  id="static-and-dynamic-notification">Static And Dynamic Notification <a href="#static-and-dynamic-notification" aria-label="Link to section 'Static And Dynamic Notification'" class="sr hsl">Link</a></h4>
<p>When push notifications are received by the Watch, it first tries to display a dynamic notification, which is a more complex interface. If screen loading takes too long, a simpler interface appears: a static notification. Unfortunately, the simulator doesn&#8217;t demonstrate this. (For details see the “Long looks” section in the <a href="https://developer.apple.com/watch/human-interface-guidelines/app-components/">App Components page</a><sup class="po" id="note-12"><a href="#12">12</a></sup>)</p>
<p>iOS allows developers to put notifications in two formats: short looks and long looks. A short look is neither static nor dynamic but a separate view, as seen in the following picture:</p>
<figure><a href="/texts/mailru/assets/static-dynamic-notification-opt.png"><img property="image" src="/texts/mailru/assets/static-dynamic-notification-opt-small.png" alt="static-dynamic-notification-opt-small" /></a><sup class="po" id="note-13"><a href="#13">13</a></sup><br />
<figcaption>A short look is neither static nor dynamic but a separate view. (<a href="/texts/mailru/assets/static-dynamic-notification-opt.png">View large version</a><sup class="po" id="note-14"><a href="#14">14</a></sup>)</figcaption>
</figure>
<p>The division into static and dynamic is for purely technical reasons. A <a href="https://devimages.apple.com.edgekey.net/watch/human-interface-guidelines/app-components/images/app-components-long-look_2x.png">dynamic long look</a><sup class="po" id="note-15"><a href="#15">15</a></sup> is a full notification screen with any kind of interface, while a static long look is a simplified view that only shows the text part of the notification’s contents. The static view is shown if the app fails to start and create a dynamic notification screen within an acceptable period of time. </p>
<figure><img src="/texts/mailru/assets/image06-opt.png" alt="image06-opt-small" /></a><br />
<figcaption>Choose recipient.</figcaption>
</figure>
<h4  id="notifications-division-of-labor-between-the-iphone-and-the-watch">Notifications: Division Of Labor Between The iPhone And The Watch <a href="#notifications-division-of-labor-between-the-iphone-and-the-watch" aria-label="Link to section 'Notifications: Division Of Labor Between The iPhone And The Watch'" class="sr hsl">Link</a></h4>
<p>Certain actions are associated with notifications, including replying to an email message, deleting it, marking it as read, an so on. Some of these actions are processed by the WatchKit extension, others by the main app. On the simulator, we couldn&#8217;t test the actions processed by the main app. These actions can be invoked directly from the phone, but if we tried to invoke them from the Watch, the simulator tried to process them in the WatchKit extension. In real life, they&#8217;re processed by the main app. This behavior is due to the fact that <strong>the simulator doesn&#8217;t support push notifications at all</strong> — neither for the iPhone nor the Watch.</p>
<p>A new possibility has appeared in the Apple Watch SDK: when the Watch app is launched from a development environment, you can put the contents of a push notification there to see how it&#8217;ll be processed. The problem is that testing all possible cases isn&#8217;t feasible. For example, <strong>it&#8217;s impossible to set whether notifications will be processed by the main app or the WatchKit extension</strong>. So we had to content ourselves with testing the actions processed by the app by invoking them from notifications on the phone (a real device) and hoping it would work the same way on the Watch.</p>
<h3  id="development-on-xcode">Development On Xcode <a href="#development-on-xcode" aria-label="Link to section 'Development On Xcode'" class="sr hsl">Link</a></h3>
<p>Everyone who works with Xcode knows that it has bugs, and each new version brings new ones. The release of the WatchKit SDK was no exception.</p>
<h4  id="certificates-for-distribution">Certificates For Distribution <a href="#certificates-for-distribution" aria-label="Link to section 'Certificates For Distribution'" class="sr hsl">Link</a></h4>
<p>Xcode has recently set a course toward automatic code signing and provisioning. In theory, Xcode creates all the profiles, necessary certificates, and the Bundle ID for you. In practice, Xcode only does it in certain cases. Specifically, we&#8217;ve found that distribution profiles for the Watch aren&#8217;t created automatically. It must be done manually on the Apple Developer Portal.</p>
<h4  id="assignment-of-separate-group-radii-for-38-and-42-mm">Assignment Of Separate Group Radii For 38 And 42 mm <a href="#assignment-of-separate-group-radii-for-38-and-42-mm" aria-label="Link to section 'Assignment Of Separate Group Radii For 38 And 42 mm'" class="sr hsl">Link</a></h4>
<p>In the Interface Builder, it&#8217;s now possible to define certain properties of elements for Watches sized 38 and 42 mm, but this doesn&#8217;t work in all cases. If you set a radius for a group for different Watch versions, there won&#8217;t be any rounding at all. We avoided this bug by setting group radii in the code and not in the Interface Builder.</p>
<h4  id="obscure-settings-and-error-messages">Obscure Settings and Error Messages <a href="#obscure-settings-and-error-messages" aria-label="Link to section 'Obscure Settings and Error Messages'" class="sr hsl">Link</a></h4>
<p>New properties have appeared in the Watch app property list, like <code>RemoteInterfacePrincipalClass</code>, whose purpose is unknown. On the one hand, it seems that it must be defined; on the other, judging from experience, its value doesn&#8217;t appear to affect anything. However, we ended up entering the correct name of the class, just in case it does do something on the real Watch.</p>
<p>The <code>SPErrorGizmoInstallNeverFinishedErrorMessage</code> error means that the simulator has some additional problems. Sometimes if you launch one Watch app, work with it, stop it, and then try to launch another, the simulator refuses to install it and displays an error with a strange name for the subheading. To fix it you must delete the simulator, reset all of the contents and fully clean out the project.</p>
<h3  id="code-reuse-between-the-app-and-the-extension">Code Reuse Between The App And The Extension <a href="#code-reuse-between-the-app-and-the-extension" aria-label="Link to section 'Code Reuse Between The App And The Extension'" class="sr hsl">Link</a></h3>
<p>We&#8217;d like to say a few things about development process optimization. MyMail&#8217;s app and the WatchKit extension perform similar functions: both let you view the contact list, send emails, and so forth. For this reason, it makes sense to use parts of the main app&#8217;s code again in the Watch. Here is how you could <strong>increase the amount of shared code on your own projects</strong>.</p>
<ul>
<li>From the outset, write modular code so that all required classes can be used in extensions without adding lots of dependencies that may not even be needed for work but will be necessary to compile.</li>
<li>Use CocoaPods, the <strong>dependency management system for Objective C</strong>. CocoaPods provides the ability to add certain libraries to various targets. It lets us add a large list of dependencies to the myMail main app&#8217;s target. Then add only those libraries from that large list necessary to the WatchKit app&#8217;s target.</li>
<li>Use Dynamic Frameworks if you&#8217;ve already stopped supporting iOS 7.</li>
<li>Use <strong>scripts for project file checking</strong>. If code files are added manually rather than through CocoaPods, make sure the targets include only the files used there. In our case, all the differences between the main target and the WatchKit target are specified in the configuration file and scripts checks them.</li>
<li>Invoke the main app using an interprocess communication API when it&#8217;s more efficient than using classes from the main app on the Watch.</li>
</ul>
<h3  id="conclusion">Conclusion <a href="#conclusion" aria-label="Link to section 'Conclusion'" class="sr hsl">Link</a></h3>
<p>In general, we&#8217;ve worked out the following (quite obvious) rules for development without a real device:</p>
<ul>
<li>Study the documentation thoroughly because it&#8217;ll be almost impossible to detect a problem in testing.</li>
<li>Provide backup options in addition to the main ones, in case the device doesn’t work the way you assume it will.</li>
<li>Use all available sources of information about the device (see &#8220;Resources section&#8221; below) — everything from official sources to geekу podcasts.</li>
</ul>
<p>With that in mind, happy designing for the Watch!</p>
<h4  class="po" id="footnotes">Footnotes <a href="#footnotes" aria-label="Link to section 'Footnotes'" class="sr hsl">Link</a></h4><ol class="po"><li id="#1"><a href="#note-1">1 https://developer.apple.com/library/prerelease/ios/documentation/General/Conceptual/WatchKitProgrammingGuide/CreatingtheUserInterface.html#//apple_ref/doc/uid/TP40014969-CH4-SW1</a></li><li id="#2"><a href="#note-2">2 https://developer.apple.com/library/prerelease/ios/documentation/UIKit/Reference/UIStackView_Class_Reference/</a></li><li id="#3"><a href="#note-3">3 https://developer.apple.com/watch/human-interface-guidelines/app-components/#glances</a></li><li id="#4"><a href="#note-4">4 https://developer.apple.com/library/ios/documentation/General/Conceptual/WatchKitProgrammingGuide/TextandLabels.html</a></li><li id="#5"><a href="#note-5">5 https://developer.apple.com/watch/human-interface-guidelines/#digital-crown</a></li><li id="#6"><a href="#note-6">6 https://developer.apple.com/watch/human-interface-guidelines/#force-touch</a></li><li id="#7"><a href="#note-7">7 https://developer.apple.com/watch/human-interface-guidelines/ui-elements/#sliders</a></li><li id="#8"><a href="#note-8">8 https://developer.apple.com/watch/human-interface-guidelines/ui-elements/#menus</a></li><li id="#9"><a href="#note-9">9 /texts/mailru/assets/image05-opt.png</a></li><li id="#10"><a href="#note-10">10 /texts/mailru/assets/image05-opt.png</a></li><li id="#11"><a href="#note-11">11 https://developer.apple.com/watch/human-interface-guidelines/app-components/#handoff</a></li><li id="#12"><a href="#note-12">12 https://developer.apple.com/watch/human-interface-guidelines/app-components/</a></li><li id="#13"><a href="#note-13">13 /texts/mailru/assets/static-dynamic-notification-opt.png</a></li><li id="#14"><a href="#note-14">14 /texts/mailru/assets/static-dynamic-notification-opt.png</a></li><li id="#15"><a href="#note-15">15 https://devimages.apple.com.edgekey.net/watch/human-interface-guidelines/app-components/images/app-components-long-look_2x.png</a></li><li id="#16"><a href="#note-16">16 https://www.smashingmagazine.com/2015/08/mymail-app-case-study/</a></li><li id="#17"><a href="#note-17">17 https://developer.apple.com/watch/human-interface-guidelines/</a></li><li id="#18"><a href="#note-18">18 https://developer.apple.com/watch/human-interface-guidelines/app-components/</a></li><li id="#19"><a href="#note-19">19 https://developer.apple.com/watch/human-interface-guidelines/ui-elements/</a></li><li id="#20"><a href="#note-20">20 https://developer.apple.com/watchkit/</a></li><li id="#21"><a href="#note-21">21 https://developer.apple.com/library/prerelease/ios/documentation/General/Conceptual/WatchKitProgrammingGuide/</a></li><li id="#22"><a href="#note-22">22 https://devforums.apple.com</a></li><li id="#23"><a href="#note-23">23 http://stackoverflow.com/search?tab=votes&amp;q=watchkit</a></li></ol>
	
	
	<div class="lt"><a href="https://www.smashingmagazine.com/tag/apps/">Apps</a><a href="https://www.smashingmagazine.com/tag/case-studies/">Case Studies</a><a href="https://www.smashingmagazine.com/tag/devices/">Devices</a></div>
<p>
	<a href="#top" class="top">&uarr; Back to top</a>

	<a onclick="clicky.log('#sharelink-clicked');" class="sot single" href="https://twitter.com/intent/tweet?original_referer=https://www.smashingmagazine.com/2015/08/mymail-app-case-study/&#038;source=tweetbutton&#038;text=myMail%20App%20Case%20Study%3A%20Developing%20For%20Apple%20Watch%20Without%20The%20Device&#038;url=https://www.smashingmagazine.com/2015/08/mymail-app-case-study/&#038;via=smashingmag">Tweet it</a><a onclick="clicky.log('#sharelink-clicked');" class="sot single" href="http://www.facebook.com/sharer/sharer.php?u=https://www.smashingmagazine.com/2015/08/mymail-app-case-study/">Share on Facebook</a></p>
	</p>

</article>

